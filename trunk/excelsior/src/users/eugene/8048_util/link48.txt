





 утвержден

 предв.0112-01 33 01-лу









                Система автоматизации проектирования
                      программного обеспечения
                         микро-эвм К1816ВЕ48

                             С А П Р 4 8


                      Программа редактор связей
                             L I N K 4 8

                      Руководство программиста


                         предв.0112-01 33 01

                              листов 7





























                               1 9 8 5

                               - 2 -

                         предв.0112-01 33 01






                              Аннотация



     Настоящий  документ  является  руководством  программиста и
оператора для работы с редактором связей LINK48.

     Программа LINK48 предназначена для преобразования об'ектных
модулей, полученных с помощью программы кросс-ассемблер MAC48, в
формат абсолютной загрузки.

     Документ   содержит  информацию  о  возможностях  программы
LINK48,   о  наборах  входных  и  выходных  данных,  о  способах
использования данной программы.


     п_р_и_м_е_ч_а_н_и_е.    в   данном   документе   ориентация
программы   LINK48   на  операционную  систему  рафос  условная.
программа редактор связей функционирует также под управлением ос
фодос, ос фобос, ос двк.

                             Содержание



    аннотация ...............................................  2
1.  назначение и условия применения программы................  4
2.  пуск программы...........................................  4
3.  ключи командной строки...................................  4
3.1.   описание ключей.......................................  5
4.  сообщения программы об ошибках...........................  6

            1. назначение и условия применения программы


     Редактор   связей   LINK48  преобразует  об'ектные  модули,
созданные  программой кросс-ассемблер MAC48, в абсолютные модули
загрузки. при этом LINK48 выполняет следующие функции:

     - соединяет отдельные об'ектные модули;
     - отыскивает глобальные символы, которые определены в
       разных модулях, и осуществляет связь;
     - создает абсолютный загрузочный модуль;
     - создает карту загрузки;

     Редактор  связей реализует двухпроходный алгоритм. во время
первого прохода программа создает таблицу глобальных символов, в
которую  входят  все  имена файлов, модулей и глобальные символы
входных  модулей.  после  первого  прохода  выводится файл карты
памяти.  во  время  второго  прохода  редактор  связей считывает
об'ектные модули и создает модуль в формате абсолютной загрузки.

     Программа LINK48 функционирует под управлением операционной
системы  рафос  см  эвм.  для работы редактору связей необходимо
минимум   32   кбайт   оперативной   памяти.  об'ектные  модули,
используемые   программой  в  качестве  входных  данных,  должны
располагаться  на  внешних  носителях  информации  с каталоговой
организацией.

                          2. пуск программы

     Для   вызова   программы   редактор   связей  с  системного
устройства  необходимо в ответ на точку, напечатанную монитором,
задать команду:

                              .R LINK48

или
                            .RU DEV:LINK48

     Если   загрузочный   модуль   находится   не  на  системном
устройстве, DEV: - имя устройства

     Командная  строка  редактора  связей  должна  удовлетворять
требованиям  формата  CSI.  выходными  файлами  редактора связей
являются (в порядке указания в командной строке) файлы типов:

.L48
  - файл программы пользователя в формате абсолютной загрузки;

.MAP
  - карта распределения памяти;

     Выходные   файлы  могут  быть  выведены  на  любое  внешнее
устройство инструментальной эвм. если имя устройства в командной
строке  не  указано,  редактор  связей  использует  по умолчанию
устройство  DK:. если в левой части командной строки отсутствуют
спецификации выходных файлов, то эти файлы не создаются.

     Входным   набором   данных   для  программы  LINK48  служат
об'ектные файлы, созданные транслятором MAC48.

.O48
  - расширение (по умолчанию) входных файлов.

     Число   входных   об'ектных   файлов   не  ограничено:  при
необходимости  командная  строка  разбивается на несколько строк
продолжения с помощью соответствующих ключей.

     Для  выхода  из  редактора  связей  и  передачи  управления
монитору  следует  нажать <CTRL/C>, если редактор связей ожидает
ввода  с  терминала,  или  дважды <CTRL/C>, если редактор связей
выполняет редактирование.

     После  завершения  работы  программа  печатает  звездочку и
ожидает ввода новой командной строки.


                      3. ключи командной строки


     В  командной  строке  редактора  связей  допускаются ключи,
указанные в таблице:

  имя  ! командная !             пояснение
       !  строка   !
=======!===========!========================================
 /C    ! любая, но ! позволяет продолжить спецификацию ввода
       !  не       ! на следующую  строку; нельзя
       ! последняя ! использовать ключ /с с комбинацией //;
       !           !
 /T или!  первая   ! заставляет редактор связей запрашивать
 /T:N  !           ! глобальный  символ, адрес которого
       !           ! является адресом запуска программы,
       !           ! или устанавливает адрес запуска  в
       !           ! значение  "N";
       !           !
 /W    !  первая   ! выдает расширенный листинг
       !           ! карты загрузки;
       !           !
 //    ! первая и  ! позволяет использовать
       ! последняя ! строки продолжения в команде.


       3.1. описание ключей


/C или //
        - ключ позволяет продолжить команду  на  нескольких  строках,
          например:

                    *OUTPUT,LP:=INPUT1,INPUT2/C
                    *INPUT3,INPUT4/C
                    *INPUT5

     Знак "//" печатается в конце первой строки, редактор связей
продолжает  принимать  дополнительные строки до тех пор, пока не
встретится другой ключ //. например:

                    *LINK,LINK=LINK0/W//
                    *LNKOV1
                    *LNKGSD
                    *LNKHDR
                    *LNKMAP
                    *LNKSAV
                    *LNKEM
                    *//

     Совместное  использование  ключей  /C  и  // в одной строке
недопустимо.

 /T[:N]
        - определяет адрес  запуска,  с  которого  начинается  работа
          программы.   ключом   /T   указывается   стартовый    адрес
          абсолютного   загрузочного   модуля,   аргумент    "N"    -
          шестизначное  восьмеричное  число.  если  "N"  не  указано,
          печатается следующее сообщение:

                       TRANSFER SYMBOL?
                       ;символ передачи?

     В  ответ  надо  указать  глобальный  символ, адрес которого
служит адресом запуска.

     В   следующем   примере   об'единяются   файлы   LIBR0.O48,
LIBR1.O48,.....,  LIBR5.O48 и DDT.O48, и начинается выполнение с
адреса запуска DDT (глобальный адрес входа DDT).

                       *LIBR,LIBR=LIBR0,DDT/T/W//
                       *LIBR1
                       *LIBR2
                       *LIBR3
                       *LIBR4
                       *LIBR5//
                       TRANSFER SYMBOL? DDT
                       *

 /W
        - ключ позволяет получить широкую распечатку карты  загрузки.
          если /W не указан, то распечатка  ведется  в  три  столбца,
          например:






        LINK48  VA1-01          03:27:25    15-JUN-84

MEMORY ALLOCATION MAP FOR DK :LIBR  .MAP


TRANSFER ADDRESS: 0002


**** MODULE .MAIN. FROM FILE  DK :LIBR0 .O48
          LAB1    0100    LAB2    0106    LAB3    0120
          LAB4    0138

**** MODULE .MAIN. FROM FILE  DK :DDT   .O48
          D.DDT   0002    D.END   0080

**** MODULE .MAIN. FROM FILE  DK :LIBR1 .O48
          LAB5    0226    LAB6    0650    LAB7    0342
          LAB8    0208    LAB9    0308

**** MODULE .MAIN. FROM FILE  DK :LIBR2 .O48

**** MODULE .MAIN. FROM FILE  DK :LIBR3 .O48
          LAB10   0094

**** MODULE .MAIN. FROM FILE  DK :LIBR4 .O48
          LAB11   0888    LAB12   0958    LAB13   0814
          LAB14   0838

**** MODULE .MAIN. FROM FILE  DK :LIBR5 .O48


                  4. сообщения программы об ошибках


     Раздел   содержит  все  диагностичские  сообщения,  которые
выдает  программа  редактор  связей  LINK48.  каждое  сообщение,
описанное  в  разделе,  приводится  в  той  форме,  в  какой оно
появляется на терминале.

      все сообщения имеют следующий формат:

        ?LINK48-T-сообщение

     Каждому сообщению предшествует имя (LINK48) программы и тип
ошибки (т) в соответствии со следующими категориями:

 F (неустранимая ошибка)
        - сообщение   выводится   на   терминал;   текущая    команда
          игнорируется и выполнение прекращается.  необходимо  ввести
          другую команду

 W (предупреждение)
        - разновидность    информационного    сообщения;    сообщение
          выводится на терминал; выполнение продолжается.

      сообщения программы:



 ?LINK48-F-BAD GSD IN FILNAM
        - была ошибка в  каталоге  глобальных  символов  (GSD).  файл
          является недопустимым об'ектным модулем.

       действия оператора:
        - убедиться, что  при  вводе  указаны  верные  имена  файлов;
          проверить  наличие  ошибки  в  командной  строке.  повторно
          оттранслировать исходную программу, чтобы получить  хороший
          об'ектный модуль. повторить операцию.



 ?LINK48-F-FILE NOT FOUND DEV:FILNAM.TYP
        - указанный входной файл не найден.

       действия оператора:
        - проверить наличие ошибки в командной строке. убедиться, что
          введенное имя файла верно и повторить операцию.



 ?LINK48-F-ILLEGAL CSI
        - неверная CSI-строка

       действия оператора:
        - проверить наличие  ошибки  в  командной  строке.  повторить
          операцию.


 ?LINK48-F-ILLEGAL DEVICE
        - неверное устойство.

       действия оператора:
        - убедиться, что указанное устройство может быть использовано
          системой.



 ?LINK48-F-INSUFFICIENT MEMORY
        - недостаточно памяти для таблицы глобальных символов.

       действия программиста:
        - уменьшить  количество  глобальных   символов   в   исходной
          программе.



 ?LINK48-F-MAP DEVICE FULL
        - в каталоге нет места для имени файла или  для  файла  карты
          загрузки.

    оператору следует воспользоваться следующими методами:

        - удалить ненужные файлы с выходного  носителя,  передав  их,
          например, на резервный носитель;

        - использовать другой носитель, имеющий больший об'ем памяти;

        - указать размер выходного файла, используя конструкцию [N] в
          спецификации выходного файла;

        - провести  операцию  "сборка  мусора",   используя   команду
          монитора  ос  рафос  "SQUEEZE";  это  создает   максимально
          возможную свободную область на носителе  путем  об'единения
          всех свободных блоков в  одну  область  и  позволяет  более
          эффективно использовать области каталога;

        - если каталог остается переполненным, можно  отвести  больше
          сегментов на другом носителе (используя команду монитора ос
          RAFOS "INITIALIZE" с ключом "/SEGMENTS:N") и передать файлы
          на этот носитель;

        - если устройство остается переполненным, нужно  использовать
          устройство с большим об'емом памяти.



 ?LINK48-F-L48 DEVICE FULL
        - в  каталоге  нет  места  для  записи  имени  файла  или  на
          устройстве  вывода  нет  места  для   загрузочного   модуля
          (".L48").

       действия оператора:
        - см. сообщение "?LINK48-F-MAP DEVICE FULL"

                               - 7 -

                         предв.0112-01 33 01


 ?LINK48-W-BAD OPTION: /A
        - в  командной  строке  указан  недопустимый  для   программы
          редактор связей ключ ("/A") или использовалась недопустимая
          комбинация ключей.

       действия оператора:
        - программа входит в режим  ожидания  ввода  новой  командной
          строки,   если   в   первой   командной   строке   появился
          недопустимый ключ.  следует  ввести  другую  команду.  ключ
          игнорируется и обработка  продолжается,  если  недопустимый
          ключ  появился  в  командной  строке  продолжения.  в  этой
          командной  строке  допустимы  только  ключи  "/C"  и  "//".
          следует проверить наличие ошибки в командной строке.



 ?LINK48-W-CHECK SUM ERROR IN MOD AAAAAA
        - ошибка контрольной  суммы  в  одном  из  блоков  об'ектного
          модуля аааааа.

       действия оператора:
        - убедиться, что  при  вводе  указаны  верные  имена  файлов.
          повторно оттранслировать исходную программу, чтобы получить
          хороший об'ектный модуль. повторить операцию.



 ?LINK48-W-CONFLICTING ATTRIBUTES BBBBBB
        - глобальный   символ   вввввв    определяется    несколькими
          несовпадающими директивами (PUBLIC, EXTERNAL). используется
          первое  определение  символа,  остальные  игнорируются,   и
          редактирование продолжается.

       действия программиста:
        - в исходной программе проверить описание глобального символа
          вввввв.



 ?LINK48-W-ILLEGAL CHARACTER
        - неразрешенный символ.

       действия оператора:
        - убедиться,  что  имя  глобального  символа  после  запроса:
          "TRANSFER SYMBOL?" было задано  правильно.  повторить  ввод
          имени глобального символа.



 ?LINK48-W-ILLEGAL TRANSFER SYMBOL
        - адрес запуска программы не определен

       действия оператора:
        - адрес   запуска   берется   равным   0000,   редактирование
          продолжается. проверить наличие ошибки в командной  строке.
          ответ  на   ключ   "/т"   должен   содержать   шестизначное
          восьмеричное число  без  знака,  или  возврат  каретки,  за
          которым следует глобальный символ, адрес которого  является
          адресом запуска абсолютного загрузочного модуля.

 ?LINK48-W-RELOCATION ERROR AT HHHH (CCC)

        - ошибка    настройки    адресной    константы;    HHHH     -
          шестнадцатеричный адрес настраиваемого байта(слова); CCC  -
          уточнение ошибки, может принимать следующие значения:

      BYTE

               - значение байта выходит за пределы от  -256  до  +256
                 (не все нули или не  все  единицы  в  старшем  байте
                 внутреннего  представления).  ошибка  возникает  при
                 настройке  операнда  директивы  "DB"  или   операнда
                 команды с непосредственным данным.

      PAGE

               - ошибка  внутристраничного  перехода:  исполнительный
                 адрес команд внутристраничного перехода  выходит  за
                 пределы страницы.

      ADDR

               - значение адреса выходит за пределы  12-ти  разрядов.
                 исполнительный адрес команд CALL или  JMP  превышает
                 значение 0FFFH.

      EXPR

               - слишком сложное выражение или деление  на  ноль  при
                 вычислении адресной константы.



      действия програмиста:

        - по карте памяти определить об'ектный модуль, в котором  при
          настройке  возникает  ошибка.   исправить   соответствующий
          исходный  модуль,  заново  его  оттранслировать  с  помощью
          программы MAC48 и отредактировать программой LINK48.



 ?LINK48-W-UNDERFINED GLOBALS:
        - перечисленые глобальные символы не определены.

       действия оператора:
        - проверить наличие ошибки в командной строке. неопределенные
          глобальные символы выдаются на терминал. исправить исходную
          программу. убедиться, что все необходимые об'ектные  модули
          указаны в командной строке.





























































































































































































































































































































































































































































